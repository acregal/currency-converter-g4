<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Currency Exchange</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link rel="shortcut icon" href="{{ url_for('static', filename='exchange-favicon.png') }}">
    <!-- Add some CSS to change client UI -->
  <style>
    .header {
      padding: 15px;
      background: #232F3E;
      color: white;
      border-bottom: 3px solid #FF9900;
    }

    h1{
      font-size: 40px;
      font-family: Georgia;
      text-align: center;
      color: white;
    }
    .date-time {
      padding: 10px;
      text-align: center;
      color: black;
    }

    body {
      background-color: #ffffff;
    }

    .column {
      float: left;
      width: 50%;
      padding: 10px;
    }
    .main:after {
      content: "";
      display: table;
      clear: both;
    }

    label{
      color: #FF9900;
      font-family: Arial, Helvetica, sans-serif;
      font-size: 20px;
      padding: 10px;
    }

    button {
      color: #232F3E;
      font-size: 13px;
      padding: 10px;
      width: 100px;
      height: 40px;
    }

    input, select {
      color: #232F3E;
      font-family: Arial, Helvetica, sans-serif;
      font-size: 15px;
      padding: 10px;
      width: 200px;
      height: 50px;
    }

    .input{
      padding-top: 100px;
      padding-left: 250px;
      padding-right: 250px;
    }

    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    footer{
      border-top: 3px solid #FF9900;
      background-color: #232F3E;
      padding: 15px;
      color: white;
      font-family: Arial;
    }

  </style>
  
  <script>
  
		function inputTest(sourceCurrency,targetCurrency,sourceAmount) {
			errorText = "";
			document.getElementById("displayErrorText").innerHTML = errorText;
			if (sourceAmount <= 0) {
				errorText = "Please enter a valid amount.";
				document.getElementById("displayErrorText").innerHTML = errorText;	
			}
			else {
			callAPI(sourceCurrency,targetCurrency,sourceAmount);
			}
		
		}
		
		
        // define the callAPI function that takes a first name and last name as parameters
        var callAPI = (sourceCurrency,targetCurrency,sourceAmount)=>{
            // instantiate a headers object
            var myHeaders = new Headers();
            // add content type header to object
            myHeaders.append("Content-Type", "application/json");
            // using built in JSON utility package turn object to string and store in a variable
            var raw = JSON.stringify({"sourceCurrency":sourceCurrency,"targetCurrency":targetCurrency,"sourceAmount":sourceAmount});
            // create a JSON object with parameters for API call and store in a variable
            var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                body: raw,
                redirect: 'follow'
            };
      // This is dev URL
      fetch("https://qw5jb2b2e1.execute-api.ap-northeast-1.amazonaws.com/dev", requestOptions)
			
			// This is PROD URL, still undergoing testing
			//fetch("https://6hf24jz48a.execute-api.ap-northeast-1.amazonaws.com/Prod", requestOptions)
            .then(response => response.text())
            .then(result => appendData(JSON.parse(result).body))
            .catch(error => console.log('error', error));
        }
		
		function appendData(result) {
			//The parsed JSON result is passed to the appendData function and then shown in the box.
            var mainContainer = document.getElementById("toAmount");
			document.getElementById("toAmount").value = result;
        }
		
		function getDateAndTime() {
			// This is done to display the date and time properly on the website
			var weekdays = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
			var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
			var currentInfo = new Date();
			var dateTime = weekdays[currentInfo.getDay()] + " " + months[currentInfo.getMonth()] + " " + currentInfo.getDate() + ", " + currentInfo.getFullYear() + " at " + currentInfo.getHours() + ":" + (currentInfo.getMinutes()<10?'0':'') + currentInfo.getMinutes();
			var timeContainer = document.getElementById("displayDateTime");
			var addDateTime = document.createElement("div");
			addDateTime.innerHTML = dateTime;
			timeContainer.appendChild(addDateTime);
		}
		window.onload = getDateAndTime;
    </script>
</head>


<body>
  <div id="container-fluid" style="min-height: 100%;">
    <div class="header">
      <h1> Currency Exchange System </h1>
    </div>

    <div class="date-time" id="displayDateTime" type="text" onload="getDateAndTime()">
    </div>

    <div class="main" style="padding-top: 40px;">
      <form>
        <div class="input">

          <div class="column">

            <table>
              <tr>
                <td><label for="fromCurrency">Currency from:</label></td>
                <td>
                  <select id="fromCurrency" name="FromCurrency">
            				<option value="USD">US Dollar</option>
            				<option value="EUR">Euro</option>
            				<option value="JPY">Japanese Yen</option>
            				<option value="GBP">Pound Sterling</option>
            				<option value="AUD">Australian Dollar</option>
            				<option value="CAD">Canadian Dollar</option>
            				<option value="CHF">Swiss Franc</option>
            				<option value="CNY">Renminbi</option>
            				<option value="HKD">Hong Kong Dollar</option>
            				<option value="NZD">New Zealand Dollar</option>
            			</select>
                </td>
              </tr>
              <tr>
                <td></td>
                <td><input type="number" placeholder="Amount" id="fromAmount" ></td>
              </tr>
			  <tr>
				<td></td>
				<td>
			    <label id="displayErrorText">
				</label>
				</td>
			  </tr>
            </table>
          </div>

          <div class="column">
            <table class="center">
              <tr>
                <td><label for="toCurrency">Currency to:</label></td>
                <td>
                  <select id="toCurrency" name="ToCurrency">
            				<option value="USD">US Dollar</option>
            				<option value="EUR">Euro</option>
            				<option value="JPY">Japanese Yen</option>
            				<option value="GBP">Pound Sterling</option>
            				<option value="AUD">Australian Dollar</option>
            				<option value="CAD">Canadian Dollar</option>
            				<option value="CHF">Swiss Franc</option>
            				<option value="CNY">Renminbi</option>
            				<option value="HKD">Hong Kong Dollar</option>
            				<option value="NZD">New Zealand Dollar</option>
            			</select>
                </td>
              </tr>
              <tr>
                <td></td>
                <td><input type="number" placeholder="Converted Amount"
                  id="toAmount" readonly style="outline: none;"></td>
              </tr>
            </table>
          </div>

        	<br><br>

          <div class="buttons" style="text-align: center; padding: inherit;">
            <button type="button" style="padding:10px;" onclick="inputTest(document.getElementById('fromCurrency').value,document.getElementById('toCurrency').value,document.getElementById('fromAmount').value)">Convert</button>
        	<button type="reset">Clear</button>
          </div>
        </div>
      </form>
    </div>
  </div>
  
  <div class="alexa-container" >
	<h2>Alexa Skill</h2>
	  <p>Users can use the Currency Exchange System on Amazon's Alexa Echo or
      phone application via the Alexa Skill: Group 4 Currency Converter.
	  </p>
	  <p>Once the Alexa Skill has been enabled try making a currency conversion
	  request by uttering the phrase:
      </p>
      <p style="text-align: center;">
      "Alexa, ask Group 4 C C to convert AMOUNT from CURRENCY to CURRENCY".
      </p>

      <div style="padding-top: 20px;">
        <p><strong>Examples:</strong></p>
        <div class="examples" style="padding-left:50px;">
          <p>
            "Alexa, ask Group 4 C C to convert 20 from USD to EUR".
          </p>
          <p>
            "Alexa, ask Group 4 C C to convert 5001 from JPY to CAD".
          </p>
          <p>
            "Alexa, ask Group 4 C C to convert 143 from CHF to SEK".
          </p>
        </div>
      </div>
    </div>
  </div>

  <footer>
      <table style="width: 100%;">
        <tr>
          <th>Class</th>
          <th>Authors</th>
        </tr>
        <tr>
          <td><ul style="list-style-type: none; color: #FF9900; font-size: 13px;">
            <li>University of Maryland Global Campus</li>
            <li>CMSC 495 6380 - Current Trends and Projects in Computer Science</li>
            <li>Dr. Hung Dao</li>
            <li>Spring 2022 - Session 1</li>
          </ul></td>

          <td><ul style="list-style-type: none; color: #FF9900; font-size: 13px;">
            <li>Anand Kumar</li>
            <li>Andrew Regal</li>
            <li>Deidra Colquitt</li>
            <li>Leslie Hawkins</li>
          </ul></td>
        </tr>
      </table>
  </footer>
  
</body>
</html>
